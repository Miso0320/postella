<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mycompany.postella.dao.DeliverAddressDao">

	<insert id="insertAddress" parameterType="DeliverAddress">
	    INSERT INTO deliver_address (da_no, da_type, us_no, sel_no, da_name, da_tel, da_postcode, da_adr, da_detail_adr, da_main, da_req_type)
	    VALUES (da_no_seq.nextval, #{da_type}, #{us_no, jdbcType=INTEGER},
	            <if test="sel_no != null">#{sel_no, jdbcType=INTEGER}</if>
	            <if test="sel_no == null">null</if>,
	            #{da_name}, #{da_tel}, #{da_postcode}, #{da_adr}, #{da_detail_adr}, #{da_main}, #{da_req_type})
	</insert>
	

 
 	<select id="selectAddressList" parameterType="int" resultType="DeliverAddress">
 		select da_no, da_type, us_no,  sel_no, da_name, da_tel, da_postcode, da_adr, da_detail_adr, da_main, get_code_value('DA', da_req_type) as da_req_type 
		from deliver_address
		where us_no = #{us_no}
 	</select>
 	
 	<select id="selectBasicAddress" parameterType="int" resultType="DeliverAddress">
 		select da_no, da_type, us_no,  sel_no, da_name, da_tel, da_postcode, da_adr, da_detail_adr, da_main, get_code_value('DA', da_req_type) as da_req_type 
		from deliver_address
		where us_no = #{us_no} and da_main = 'Y'
 	</select>
 	
 	<select id="getKorRequest" parameterType="String" resultType="String">
 		select codeval
		from code
		where groupvalue = 'DELIVER_ADDRESS_DA_REQ_TYPE'
		and code = #{da_req_type}
 	</select>
</mapper>